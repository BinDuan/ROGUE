---
title: "R Notebook"
output: html_notebook
---

#Cell type validation

```{r}
path1 <- "/home/pauling/projects/04_SEmodel/01_data/04_rogue/02_cell_type_validation/01_colon_epithelial/matr.rds.gz"
path2 <- "/home/pauling/projects/04_SEmodel/01_data/04_rogue/02_cell_type_validation/01_colon_epithelial/meta.rds.gz"

matr <- readr::read_rds(path1)
meta <- readr::read_rds(path2)
```

```{r}
index <- meta %>% 
  dplyr::filter(Cluster == "BEST4+/OTOP2+ Cell") %>% 
  dplyr::filter(Condition == "Healthy") %>%  
  dplyr::filter(Patient == "B1") %>%
  dplyr::pull(index)

mm <- matr[index,]
ent.res <- SE_fun(mm, r = 1, span = 0.5)
ent.res <- matr_toli(ent.res, mm, span = 0.5, r = 1, n = 5)
SEplot(ent.res, p.adj = T)
```

